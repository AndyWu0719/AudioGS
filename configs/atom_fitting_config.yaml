# Stage 00: Atom Fitting Config (Simplified Speech-Aware)
# ========================================================

# Data
data:
  dataset_path: "/data0/determined/users/andywu/GS-TS/data/raw/LibriTTS_R/train/train-clean-100"
  sample_rate: 24000
  max_audio_length: 3.0

# Model
model:
  initial_atoms_per_second: 1024
  max_atoms_per_second: 4096

# Initialization (Constant-Q)
initialization:
  constant_q_cycles: 4.0
  sigma_min: 0.001
  sigma_max: 0.100

# Training
training:
  learning_rate: 0.01
  lr_amplitude: 0.005
  lr_position: 0.001
  lr_frequency: 0.003
  lr_sigma: 0.01
  lr_phase: 0.015
  lr_chirp: 0.002
  max_iters: 12000
  log_interval: 50
  vis_interval: 2000

# Loss (Balanced weights for speech)
loss:
  fft_sizes: [2048, 1024, 512, 128]
  hop_sizes: [512, 256, 128, 32]
  win_lengths: [2048, 1024, 512, 128]
  spectral_weight: 1.0
  mel_weight: 5.0              # RESTORED: higher for spectral envelope
  time_domain_weight: 0.1
  phase_weight: 1.0
  amp_reg_weight: 0.0001
  pre_emp_weight: 2.0

# Density Control (Simplified)
density_control:
  grad_threshold: 0.0002
  prune_amplitude_threshold: 0.0005  # LOWERED: conservative pruning
  densify_from_iter: 500
  densify_until_iter: 10000
  densification_interval: 100
  sigma_diversity_weight: 0.001
  enable_split: true
  cq_cycle_limit: 50.0
  cq_reg_weight: 0.01          # LOWERED: linear penalty

# Output
output:
  root_dir: "logs/00_atom_fitting"
  save_audio: true
  save_visualization: true
